<template>
  <require from="components/authors"></require>

  <section class="ebook-panel">
    <div class="container-fluid items-header" css="display: ${paginator.lastPage===0?'none':'block'}">
      <h3 class="page-title"><i class="fa fa-file-text-o" aria-hidden="true"></i>
        ${paginator.page} of ${paginator.lastPage}
    <div class='sorter' if.bind="sortings.length">
      <label class="sorter-label"><i class="fa fa-sort"></i></label>
      <sorter  sortings.one-time="sortings" view-model.ref="sorter"></sorter>
    </div>
    </h2>
  </div>

  <div class="alert alert-warning" role="alert" if.bind="paginator.lastPage === 0">
    <b>No ebooks found!</b>
  </div>

<page-controller view-model.ref='paginator' loader.bind="loader" sort.bind="sorter.sort" page-size="12" no-sort.bind="!sortings.length"></page-controller>

    <div class="container-fluid">
      <div class="row">
        <div class="col-sm-6 col-md-4 col-lg-3" repeat.for="ebook of paginator.data">
          <div class='ebook-detail'>
              <a route-href="route: ebook; params.bind: {id:ebook.id}"><div class="ebook-cover missing">
                <img src.bind="getThumbSource(ebook)" if.bind="ebook.cover"
                error.trigger="handleImgError($event)" load.trigger="handleImgLoad($event)"></div></a>
            <div class="ebook-info">
            <authors authors.one-time="ebook.authors" compact.bind="true"></authors>
            <div class="ebook-title"><a route-href="route: ebook; params.bind: {id:ebook.id}">${ebook.title}</a></div>
            <div class="ebook-series" if.bind="ebook.series">
              <a route-href="route: series; params.bind: {id:ebook.series.id}">${ebook.series.title}</a> #${ebook.series_index}</div>
          </div>
          </div>
        </div>
      </div>
    </div>

  <pager page.two-way="paginator.page" last-page.bind="paginator.lastPage" loading.bind="paginator.loading"></pager>
</section>

<div class=container>
<error-alert error.bind="paginator.error" dismissible.one-time="false"></error-alert>
</div>

</template>
