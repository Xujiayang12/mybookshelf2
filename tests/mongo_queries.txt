#MONGO SUCKS!

list(ebooks.aggregate([{'$project':{'authors':True, '_id':False}},{'$unwind':'$authors'}, {'$group':{'_id':'$authors','count':{'$sum':1}}}, {'$sort':{'_id.lastname':-1,'_id.first_name':-1}}, {'$skip':1000}, {'$limit':5}, {'$project':{'_id':0, 'count':1, 'lastname':'$_id.lastname', 'firstname':'$_id.firstname'}}]))
list(ebooks.aggregate([{'$project':{'series':1, 'authors':1, '_id':0}}, {'$unwind':'$authors'}, {'$group':{'_id':'$series', 'authors':{'$addToSet':'$authors'}}}, {'$project':{'_id':0,'authors':1,'series':'$_id'}}]))
ebooks.create_index((('title','text'), ('series','text'), ('authors.lastname','text'), ('authors.firstname', 'text')), name='fulltext', language_override= "xxx", default_language='none')

 s?where={"$text":{"$search":"cap zbynek"}}&projection={"score":{"$meta":"textScore"}}&sort=[("score", {"$meta": "textScore'})]